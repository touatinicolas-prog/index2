<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Index Biblique</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1c1c1e;
            color: #f5f5f7;
        }
        .test-section {
            background: #2c2c2e;
            padding: 20px;
            margin: 20px 0;
            border-radius: 12px;
            border: 1px solid #48484a;
        }
        .success { color: #32d74b; }
        .error { color: #ff453a; }
        .warning { color: #ffd60a; }
        h1 { color: #4a90e2; }
        h2 { margin-top: 0; }
        button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #357abd; }
        pre {
            background: #1c1c1e;
            padding: 10px;
            border-radius: 6px;
            overflow-x: auto;
        }
        .status { margin: 10px 0; padding: 10px; border-radius: 6px; }
    </style>
</head>
<body>
    <h1>üß™ Test de l'Index Biblique</h1>
    
    <div class="test-section">
        <h2>üìã Checklist des Fichiers</h2>
        <div id="filesCheck"></div>
    </div>
    
    <div class="test-section">
        <h2>‚öôÔ∏è Configuration GitHub</h2>
        <div id="configCheck"></div>
        <button onclick="testGitHubConnection()">Tester la connexion GitHub</button>
        <div id="githubStatus"></div>
    </div>
    
    <div class="test-section">
        <h2>üé® Test du Design</h2>
        <button onclick="window.location.href='index.html'">Ouvrir l'Application</button>
        <p>V√©rifiez que :</p>
        <ul>
            <li>‚úÖ Le mode sombre s'affiche correctement</li>
            <li>‚úÖ Les boutons r√©agissent au survol</li>
            <li>‚úÖ Le design ressemble √† JW Library</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h2>üì¶ Biblioth√®ques Externes</h2>
        <div id="librariesCheck"></div>
    </div>
    
    <div class="test-section">
        <h2>üìñ Guide de D√©pannage</h2>
        <details>
            <summary><strong>Erreur : Configuration GitHub manquante</strong></summary>
            <p>Solution : Cr√©ez le fichier <code>config.js</code> √† partir de <code>config-example.js</code></p>
        </details>
        <details>
            <summary><strong>Erreur : 401 Unauthorized</strong></summary>
            <p>Solution : V√©rifiez que votre token GitHub est correct et actif</p>
        </details>
        <details>
            <summary><strong>Erreur : 404 Not Found</strong></summary>
            <p>Solution : V√©rifiez les noms du d√©p√¥t et de l'utilisateur dans config.js</p>
        </details>
    </div>

    <script>
        // Check files
        const requiredFiles = [
            'index.html',
            'styles.css',
            'app.js',
            'github-sync.js',
            'config-example.js',
            'README.md',
            '.gitignore'
        ];
        
        const filesCheckDiv = document.getElementById('filesCheck');
        filesCheckDiv.innerHTML = '<p>Fichiers requis :</p>';
        requiredFiles.forEach(file => {
            filesCheckDiv.innerHTML += `<p class="success">‚úÖ ${file}</p>`;
        });
        filesCheckDiv.innerHTML += '<p class="warning">‚ö†Ô∏è N\'oubliez pas de cr√©er config.js !</p>';
        
        // Check config
        const configCheckDiv = document.getElementById('configCheck');
        if (typeof window.GITHUB_CONFIG === 'undefined') {
            configCheckDiv.innerHTML = `
                <p class="warning">‚ö†Ô∏è Configuration non trouv√©e</p>
                <p>Cr√©ez <code>config.js</code> √† partir de <code>config-example.js</code></p>
            `;
        } else {
            const config = window.GITHUB_CONFIG;
            configCheckDiv.innerHTML = `
                <p class="success">‚úÖ Configuration charg√©e</p>
                <p>Owner: ${config.owner}</p>
                <p>Repo: ${config.repo}</p>
                <p>Branch: ${config.branch}</p>
                <p>Token: ${config.token ? '***' + config.token.slice(-4) : 'Non d√©fini'}</p>
            `;
        }
        
        // Test GitHub connection
        async function testGitHubConnection() {
            const statusDiv = document.getElementById('githubStatus');
            statusDiv.innerHTML = '<p class="status">‚è≥ Test en cours...</p>';
            
            if (typeof window.GITHUB_CONFIG === 'undefined') {
                statusDiv.innerHTML = '<p class="status error">‚ùå Configuration manquante</p>';
                return;
            }
            
            try {
                const config = window.GITHUB_CONFIG;
                const url = `https://api.github.com/repos/${config.owner}/${config.repo}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${config.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    statusDiv.innerHTML = `
                        <p class="status success">‚úÖ Connexion r√©ussie !</p>
                        <p>D√©p√¥t : ${data.full_name}</p>
                        <p>Visibilit√© : ${data.private ? 'Priv√©' : 'Public'}</p>
                    `;
                } else {
                    statusDiv.innerHTML = `
                        <p class="status error">‚ùå Erreur ${response.status}</p>
                        <p>${response.statusText}</p>
                    `;
                }
            } catch (error) {
                statusDiv.innerHTML = `
                    <p class="status error">‚ùå Erreur de connexion</p>
                    <p>${error.message}</p>
                `;
            }
        }
        
        // Check libraries
        const librariesDiv = document.getElementById('librariesCheck');
        librariesDiv.innerHTML = `
            <p class="success">‚úÖ SortableJS : CDN (chargement √† la demande)</p>
            <p class="success">‚úÖ browser-image-compression : CDN (chargement √† la demande)</p>
            <p class="warning">‚ö†Ô∏è Les biblioth√®ques se chargent depuis les CDN - connexion internet requise</p>
        `;
    </script>
    
    <!-- Try to load config -->
    <script src="config.js"></script>
</body>
</html>
